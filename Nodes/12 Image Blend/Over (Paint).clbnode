// To learn how to write nodes, see https://coollab-art.com/Tutorials/Writing%20Nodes/Intro

INPUT sRGB_PremultipliedA 'Background';

sRGB_PremultipliedA main(sRGB_PremultipliedA Foreground)
{
    float new_alpha = Foreground.a + (1. - Foreground.a) * 'Background'.a;
    return vec4(
        premultiply(
            mixbox_lerp(
                unpremultiply('Background'.rgb, 'Background'.a),
                unpremultiply(Foreground.rgb, Foreground.a),
                Foreground.a
            ),
            new_alpha
        ),
        new_alpha
    );
}